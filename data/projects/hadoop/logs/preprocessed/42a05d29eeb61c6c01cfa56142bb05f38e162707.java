hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
checkpointer
java
try
backup
node
namesystem
set
image
loaded
if
backup
node
namesystem
get
blocks
total
long
complete
blocks
total
backup
node
namesystem
get
complete
blocks
total
backup
node
namesystem
set
block
total
complete
blocks
total
bn
image
save
fs
image
in
all
dirs
backup
node
get
namesystem
txid
if
backup
node
namesystem
is
rolling
upgrade
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
fs
namesystem
java
assert
safe
mode
null
is
populating
repl
queues
startup
progress
prog
name
node
get
startup
progress
prog
begin
phase
phase
safemode
long
complete
blocks
total
get
complete
blocks
total
prog
set
total
phase
safemode
step
awaiting
reported
blocks
complete
blocks
total
set
block
total
complete
blocks
total
block
manager
activate
conf
finally
write
unlock
public
void
set
block
total
long
complete
blocks
total
safe
mode
info
safe
mode
this
safe
mode
if
safe
mode
null
return
safe
mode
set
block
total
int
complete
blocks
total
public
long
get
complete
blocks
total
long
num
uc
blocks
read
lock
try
num
uc
blocks
lease
manager
get
num
under
construction
blocks
return
get
blocks
total
num
uc
blocks
finally
read
unlock
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
lease
manager
java
import
java
io
io
exception
import
java
util
array
list
import
java
util
collection
import
java
util
collections
import
java
util
comparator
import
java
util
hash
map
import
java
util
hash
set
visible
for
testing
public
synchronized
int
count
lease
return
sorted
leases
size
synchronized
long
count
path
return
leases
by
id
size
return
holder
hash
code
private
collection
long
get
files
return
collections
unmodifiable
collection
files
string
get
holder
return
holder
hadoop
hdfs
project
hadoop
hdfs
src
test
java
org
apache
hadoop
hdfs
server
namenode
test
lease
manager
java
package
org
apache
hadoop
hdfs
server
namenode
import
static
org
hamcrest
core
matchers
is
import
static
org
junit
assert
assert
equals
import
static
org
junit
assert
assert
not
null
import
static
org
junit
assert
assert
null
import
com
google
common
collect
lists
import
org
apache
hadoop
fs
permission
fs
permission
import
org
apache
hadoop
fs
permission
permission
status
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
junit
rule
import
org
junit
test
import
org
junit
rules
timeout
import
java
util
array
list
import
static
org
junit
assert
assert
that
import
static
org
mockito
mockito
public
class
test
lease
manager
rule
public
timeout
timeout
new
timeout
test
public
void
test
remove
leases
throws
exception
fs
namesystem
fsn
mock
fs
namesystem
class
test
public
void
test
check
lease
not
infinite
loop
lease
manager
lm
new
lease
manager
make
mock
fs
name
system
lm
set
lease
period
lm
check
leases
test
public
void
test
count
path
lease
manager
lm
new
lease
manager
make
mock
fs
name
system
lm
add
lease
holder
assert
that
lm
count
path
is
lm
add
lease
holder
assert
that
lm
count
path
is
lm
add
lease
holder
assert
that
lm
count
path
is
assert
that
lm
count
path
is
lm
remove
lease
holder
stub
inode
file
lm
remove
lease
invalid
lease
holder
stub
inode
file
assert
that
lm
count
path
is
node
file
file
stub
inode
file
lm
reassign
lease
lm
get
lease
file
file
holder
assert
that
lm
count
path
is
lm
remove
lease
holder
stub
inode
file
assert
that
lm
count
path
is
private
static
fs
namesystem
make
mock
fs
name
system
fs
directory
dir
mock
fs
directory
class
fs
namesystem
fsn
mock
fs
namesystem
class
when
fsn
is
running
then
return
true
when
fsn
has
write
lock
then
return
true
when
fsn
get
fs
directory
then
return
dir
return
fsn
private
static
node
file
stub
inode
file
long
inode
id
permission
status
new
permission
status
dummy
dummy
new
fs
permission
short
return
new
node
file
inode
id
foo
get
bytes
block
info
empty
array
short

hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
blockmanagement
block
collection
java
public
block
info
contiguous
under
construction
set
last
block
block
info
last
block
datanode
storage
info
targets
throws
io
exception
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
blockmanagement
block
info
java
protected
object
triplets
public
block
uc
state
get
block
uc
state
public
block
info
contiguous
under
construction
convert
to
block
under
construction
block
uc
state
datanode
storage
info
targets
if
is
complete
block
info
contiguous
under
construction
uc
block
new
block
info
contiguous
under
construction
this
get
block
collection
get
preferred
block
replication
targets
uc
block
set
block
collection
get
block
collection
return
uc
block
block
info
contiguous
under
construction
uc
block
block
info
contiguous
under
construction
this
uc
block
set
block
uc
state
uc
block
set
expected
locations
targets
uc
block
set
block
collection
get
block
collection
return
uc
block
override
public
int
hash
code
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
java
import
org
apache
hadoop
classification
interface
audience
import
org
apache
hadoop
hdfs
protocol
block
interface
audience
private
public
class
block
info
contiguous
extends
block
info
public
static
final
block
info
contiguous
empty
array
public
block
info
contiguous
short
size
super
size
protected
block
info
contiguous
block
info
contiguous
from
super
from
private
int
ensure
capacity
int
num
assert
this
triplets
null
block
info
is
not
initialized
int
last
num
nodes
if
triplets
length
last
num
return
last
object
old
triplets
triplets
new
object
last
num
system
arraycopy
old
triplets
last
return
last
override
boolean
add
storage
datanode
storage
info
storage
int
last
node
ensure
capacity
set
storage
info
last
node
storage
set
next
last
node
null
set
previous
last
node
null
return
true
override
boolean
remove
storage
datanode
storage
info
storage
int
dn
index
find
storage
info
storage
if
dn
index
return
false
assert
get
previous
dn
index
null
get
next
dn
index
null
block
is
still
in
the
list
and
must
be
removed
first
int
last
node
num
nodes
set
storage
info
dn
index
get
storage
info
last
node
set
next
dn
index
get
next
last
node
set
previous
dn
index
get
previous
last
node
set
storage
info
last
node
null
set
next
last
node
null
set
previous
last
node
null
return
true
override
public
int
num
nodes
assert
this
triplets
null
block
info
is
not
initialized
assert
triplets
length
malformed
block
info
for
int
idx
get
capacity
idx
idx
if
get
datanode
idx
null
return
idx
return
override
void
replace
block
block
info
new
block
assert
new
block
instanceof
block
info
contiguous
for
int
this
num
nodes
final
datanode
storage
info
storage
this
get
storage
info
final
boolean
removed
storage
remove
block
this
assert
removed
current
block
not
found
final
datanode
storage
info
add
block
result
result
storage
add
block
new
block
assert
result
datanode
storage
info
add
block
result
added
new
block
already
exists
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
java
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
java
package
org
apache
hadoop
hdfs
server
blockmanagement
import
java
io
io
exception
import
java
util
array
list
import
java
util
iterator
import
java
util
list
import
org
apache
hadoop
hdfs
protocol
block
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
block
uc
state
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
replica
state
import
org
apache
hadoop
hdfs
server
namenode
name
node
public
class
block
info
contiguous
under
construction
extends
block
info
contiguous
private
block
uc
state
block
uc
state
private
list
replica
under
construction
replicas
private
int
primary
node
index
private
long
block
recovery
id
private
block
truncate
block
static
class
replica
under
construction
extends
block
private
final
datanode
storage
info
expected
location
private
replica
state
state
private
boolean
chosen
as
primary
replica
under
construction
block
block
datanode
storage
info
target
replica
state
state
super
block
this
expected
location
target
this
state
state
this
chosen
as
primary
false
private
datanode
storage
info
get
expected
storage
location
return
expected
location
replica
state
get
state
return
state
boolean
get
chosen
as
primary
return
chosen
as
primary
void
set
state
replica
state
state
void
set
chosen
as
primary
boolean
chosen
as
primary
this
chosen
as
primary
chosen
as
primary
boolean
is
alive
return
expected
location
get
datanode
descriptor
is
alive
override
public
int
hash
code
return
super
hash
code
override
public
boolean
equals
object
obj
return
this
obj
super
equals
obj
override
public
string
to
string
final
string
builder
new
string
builder
append
string
to
return
to
string
override
public
void
append
string
to
string
builder
sb
sb
append
replica
uc
append
expected
location
append
append
state
append
public
block
info
contiguous
under
construction
block
blk
short
replication
this
blk
replication
block
uc
state
under
construction
null
public
block
info
contiguous
under
construction
block
blk
short
replication
block
uc
state
state
datanode
storage
info
targets
super
blk
replication
assert
get
block
uc
state
block
uc
state
complete
block
info
under
construction
cannot
be
in
complete
state
this
block
uc
state
state
set
expected
locations
targets
block
info
convert
to
complete
block
throws
io
exception
assert
get
block
uc
state
block
uc
state
complete
trying
to
convert
complete
block
return
new
block
info
contiguous
this
public
void
set
expected
locations
datanode
storage
info
targets
int
num
locations
targets
null
targets
length
this
replicas
new
array
list
replica
under
construction
num
locations
for
int
num
locations
replicas
add
new
replica
under
construction
this
targets
replica
state
rbw
public
datanode
storage
info
get
expected
storage
locations
int
num
locations
replicas
null
replicas
size
datanode
storage
info
storages
new
datanode
storage
info
num
locations
for
int
num
locations
storages
replicas
get
get
expected
storage
location
return
storages
public
int
get
num
expected
locations
return
replicas
null
replicas
size
override
public
block
uc
state
get
block
uc
state
return
block
uc
state
void
set
block
uc
state
block
uc
state
block
uc
state
public
long
get
block
recovery
id
return
block
recovery
id
public
block
get
truncate
block
return
truncate
block
public
void
set
truncate
block
block
recovery
block
this
truncate
block
recovery
block
public
void
set
generation
stamp
and
verify
replicas
long
gen
stamp
set
generation
stamp
gen
stamp
if
replicas
null
return
for
replica
under
construction
replicas
if
gen
stamp
get
generation
stamp
get
expected
storage
location
remove
block
this
name
node
block
state
change
log
debug
block
removing
stale
replica
from
location
get
expected
storage
location
void
commit
block
block
block
throws
io
exception
if
get
block
id
block
get
block
id
throw
new
io
exception
trying
to
commit
inconsistent
block
id
block
get
block
id
expected
id
get
block
id
block
uc
state
block
uc
state
committed
this
set
get
block
id
block
get
num
bytes
block
get
generation
stamp
set
generation
stamp
and
verify
replicas
block
get
generation
stamp
public
void
initialize
block
recovery
long
recovery
id
set
block
uc
state
block
uc
state
under
recovery
block
recovery
id
recovery
id
if
replicas
size
name
node
block
state
change
log
warn
block
block
info
under
construction
init
lease
recovery
no
blocks
found
lease
removed
boolean
all
live
replicas
tried
as
primary
true
for
int
replicas
size
if
replicas
get
is
alive
all
live
replicas
tried
as
primary
all
live
replicas
tried
as
primary
replicas
get
get
chosen
as
primary
if
all
live
replicas
tried
as
primary
for
int
replicas
size
replicas
get
set
chosen
as
primary
false
long
most
recent
last
update
replica
under
construction
primary
null
primary
node
index
for
int
replicas
size
if
replicas
get
is
alive
replicas
get
get
chosen
as
primary
continue
final
replica
under
construction
ruc
replicas
get
final
long
last
update
ruc
get
expected
storage
location
get
datanode
descriptor
get
last
update
monotonic
if
last
update
most
recent
last
update
primary
node
index
primary
ruc
most
recent
last
update
last
update
if
primary
null
primary
get
expected
storage
location
get
datanode
descriptor
add
block
to
be
recovered
this
primary
set
chosen
as
primary
true
name
node
block
state
change
log
debug
block
recovery
started
primary
this
primary
void
add
replica
if
not
present
datanode
storage
info
storage
block
block
replica
state
state
iterator
replica
under
construction
it
replicas
iterator
while
it
has
next
replica
under
construction
it
next
datanode
storage
info
expected
location
get
expected
storage
location
if
expected
location
storage
set
generation
stamp
block
get
generation
stamp
return
else
if
expected
location
null
expected
location
get
datanode
descriptor
storage
get
datanode
descriptor
it
remove
break
replicas
add
new
replica
under
construction
block
storage
state
override
public
int
hash
code
return
super
hash
code
override
public
boolean
equals
object
obj
return
this
obj
super
equals
obj
override
public
string
to
string
final
string
builder
new
string
builder
append
string
to
return
to
string
override
public
void
append
string
to
string
builder
sb
super
append
string
to
sb
append
uc
parts
sb
private
void
append
uc
parts
string
builder
sb
sb
append
uc
state
append
block
uc
state
append
truncate
block
truncate
block
append
primary
node
index
append
primary
node
index
append
replicas
if
replicas
null
iterator
replica
under
construction
iter
replicas
iterator
if
iter
has
next
iter
next
append
string
to
sb
while
iter
has
next
sb
append
iter
next
append
string
to
sb
sb
append
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
blockmanagement
block
manager
java
private
static
boolean
commit
block
final
block
info
contiguous
under
construction
block
final
block
commit
block
throws
io
exception
if
block
get
block
uc
state
block
uc
state
committed
return
false
return
false
final
boolean
commit
block
block
info
contiguous
under
construction
last
block
commit
block
if
count
nodes
last
block
live
replicas
min
replication
complete
block
bc
bc
num
blocks
false
return
block
info
cur
block
bc
get
blocks
blk
index
if
cur
block
is
complete
return
cur
block
block
info
contiguous
under
construction
uc
block
block
info
contiguous
under
construction
cur
block
int
num
nodes
uc
block
num
nodes
if
force
num
nodes
min
replication
throw
new
io
exception
cannot
complete
block
public
block
info
force
complete
block
final
block
collection
bc
final
block
info
contiguous
under
construction
block
throws
io
exception
block
commit
block
block
return
complete
block
bc
block
true
datanode
storage
info
targets
get
storages
old
block
block
info
contiguous
under
construction
uc
block
bc
set
last
block
old
block
targets
blocks
map
replace
block
uc
block
private
located
block
create
located
block
final
block
info
blk
final
long
pos
throws
io
exception
if
blk
instanceof
block
info
contiguous
under
construction
if
blk
is
complete
throw
new
io
exception
blk
instanceof
block
info
under
construction
blk
is
complete
blk
blk
final
block
info
contiguous
under
construction
uc
block
info
contiguous
under
construction
blk
final
datanode
storage
info
storages
uc
get
expected
storage
locations
final
extended
block
eb
new
extended
block
namesystem
get
block
pool
id
blk
return
new
located
block
eb
storages
pos
false
static
class
stateful
block
info
final
block
info
contiguous
under
construction
stored
block
final
block
reported
block
final
replica
state
reported
state
stateful
block
info
block
info
contiguous
under
construction
stored
block
block
reported
block
replica
state
reported
state
this
stored
block
stored
block
this
reported
block
reported
block
block
to
mark
corrupt
block
info
stored
long
gs
string
reason
reason
reason
code
this
new
block
info
contiguous
block
info
contiguous
stored
stored
reason
reason
code
corrupted
set
generation
stamp
gs
if
is
block
under
construction
stored
block
uc
state
reported
state
block
info
contiguous
under
construction
stored
block
add
replica
if
not
present
storage
info
iblk
reported
state
block
info
contiguous
under
construction
block
uc
block
info
contiguous
under
construction
stored
block
if
namesystem
is
in
snapshot
block
uc
int
num
of
replicas
block
uc
get
num
expected
locations
namesystem
increment
safe
block
count
num
of
replicas
if
is
block
under
construction
stored
block
uc
state
reported
state
to
uc
add
new
stateful
block
info
block
info
contiguous
under
construction
stored
block
new
block
block
reported
state
return
stored
block
void
add
stored
block
under
construction
stateful
block
info
uc
block
datanode
storage
info
storage
info
throws
io
exception
block
info
contiguous
under
construction
block
uc
block
stored
block
block
add
replica
if
not
present
storage
info
uc
block
reported
block
uc
block
reported
state
assert
block
null
namesystem
has
write
lock
block
info
stored
block
datanode
descriptor
node
storage
info
get
datanode
descriptor
if
block
instanceof
block
info
contiguous
under
construction
stored
block
blocks
map
get
stored
block
block
else
string
src
block
info
blocks
for
block
info
blocks
if
is
complete
final
block
info
contiguous
under
construction
uc
block
info
contiguous
under
construction
final
int
num
nodes
num
nodes
log
info
block
is
not
complete
uc
state
uc
get
block
uc
state
replication
num
nodes
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
blockmanagement
datanode
descriptor
java
private
final
block
queue
block
target
pair
replicate
blocks
new
block
queue
private
final
block
queue
block
info
contiguous
under
construction
recover
blocks
new
block
queue
block
info
contiguous
under
construction
private
final
light
weight
hash
set
block
invalidate
blocks
new
light
weight
hash
set
void
add
block
to
be
recovered
block
info
contiguous
under
construction
block
if
recover
blocks
contains
block
block
manager
log
info
block
is
already
in
the
recovery
queue
return
replicate
blocks
poll
max
transfers
public
block
info
contiguous
under
construction
get
lease
recovery
command
int
max
transfers
list
block
info
contiguous
under
construction
blocks
recover
blocks
poll
max
transfers
if
blocks
null
return
null
return
blocks
to
array
new
block
info
contiguous
under
construction
blocks
size
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
blockmanagement
datanode
manager
java
block
info
contiguous
under
construction
blocks
nodeinfo
get
lease
recovery
command
integer
max
value
if
blocks
null
block
recovery
command
br
command
new
block
recovery
command
blocks
length
for
block
info
contiguous
under
construction
blocks
final
datanode
storage
info
storages
get
expected
storage
locations
final
list
datanode
storage
info
recovery
locations
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
fs
dir
truncate
op
java
import
org
apache
hadoop
hdfs
protocol
quota
exceeded
exception
import
org
apache
hadoop
hdfs
protocol
snapshot
access
control
exception
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
blockmanagement
block
manager
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
block
uc
state
import
org
apache
hadoop
hdfs
server
namenode
fs
namesystem
recover
lease
op
final
block
info
last
file
get
last
block
if
last
null
last
get
block
uc
state
block
uc
state
under
recovery
final
block
truncated
block
block
info
contiguous
under
construction
last
get
truncate
block
if
truncated
block
null
final
long
truncate
length
file
compute
file
size
false
false
old
block
block
info
contiguous
under
construction
truncated
block
uc
block
manager
block
manager
fsn
get
fs
directory
get
block
manager
if
should
copy
on
truncate
truncated
block
uc
new
block
info
contiguous
under
construction
new
block
file
get
preferred
block
replication
truncated
block
uc
set
num
bytes
old
block
get
num
bytes
last
block
delta
truncated
block
uc
set
truncate
block
old
block
block
manager
convert
last
block
to
under
construction
file
last
block
delta
old
block
file
get
last
block
assert
old
block
is
complete
old
block
should
be
under
construction
truncated
block
uc
block
info
contiguous
under
construction
old
block
truncated
block
uc
set
truncate
block
new
block
old
block
truncated
block
uc
get
truncate
block
set
num
bytes
old
block
get
num
bytes
last
block
delta
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
fs
dir
write
file
op
java
import
org
apache
hadoop
hdfs
protocol
quota
exceeded
exception
import
org
apache
hadoop
hdfs
security
token
block
block
token
identifier
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
blockmanagement
block
manager
import
org
apache
hadoop
hdfs
server
blockmanagement
datanode
storage
info
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
block
block
throws
io
exception
block
info
contiguous
under
construction
uc
file
node
remove
last
block
block
if
uc
null
return
false
else
block
info
last
block
in
file
pending
file
get
last
block
block
info
contiguous
under
construction
last
block
in
file
set
expected
locations
targets
offset
pending
file
compute
file
size
return
make
located
block
fsn
last
block
in
file
targets
offset
file
node
get
preferred
block
replication
true
block
info
contiguous
under
construction
block
info
new
block
info
contiguous
under
construction
block
file
node
get
file
replication
hdfs
server
constants
block
uc
state
under
construction
allocation
of
new
block
in
src
returning
previously
allocated
block
last
block
in
file
long
offset
file
compute
file
size
block
info
contiguous
under
construction
last
block
uc
block
info
contiguous
under
construction
last
block
in
file
on
retry
block
make
located
block
fsn
last
block
in
file
last
block
uc
get
expected
storage
locations
offset
return
new
file
state
file
src
iip
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
fs
edit
log
loader
java
import
org
apache
hadoop
hdfs
protocol
layout
version
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
rolling
upgrade
startup
option
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
startup
option
old
last
block
set
num
bytes
block
get
num
bytes
if
old
last
block
instanceof
block
info
contiguous
under
construction
fs
namesys
get
block
manager
force
complete
block
file
block
info
contiguous
under
construction
old
last
block
fs
namesys
get
block
manager
process
queued
messages
for
block
block
else
preconditions
check
state
old
blocks
null
old
blocks
length
block
info
new
bi
new
block
info
contiguous
under
construction
new
block
file
get
preferred
block
replication
fs
namesys
get
block
manager
add
block
collection
new
bi
file
file
add
block
new
bi
old
block
get
generation
stamp
new
block
get
generation
stamp
old
block
set
generation
stamp
new
block
get
generation
stamp
if
old
block
instanceof
block
info
contiguous
under
construction
is
last
block
op
should
complete
last
block
change
made
true
fs
namesys
get
block
manager
force
complete
block
file
block
info
contiguous
under
construction
old
block
if
change
made
new
bi
new
block
info
contiguous
under
construction
new
block
file
get
preferred
block
replication
else
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
fs
image
format
java
import
org
apache
hadoop
hdfs
protocol
layout
version
feature
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
blockmanagement
block
manager
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
startup
option
if
blocks
length
block
info
last
blk
blocks
blocks
length
blocks
blocks
length
new
block
info
contiguous
under
construction
last
blk
replication
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
fs
image
format
pbi
node
java
import
org
apache
hadoop
hdfs
protocol
pb
pb
helper
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
blockmanagement
block
manager
import
org
apache
hadoop
hdfs
server
namenode
fs
image
format
protobuf
loader
context
import
org
apache
hadoop
hdfs
server
namenode
fs
image
format
protobuf
saver
context
if
blocks
length
block
info
last
blk
file
get
last
block
file
set
block
file
num
blocks
new
block
info
contiguous
under
construction
last
blk
replication
return
file
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
fs
image
serialization
java
import
org
apache
hadoop
hdfs
protocol
layout
version
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
block
uc
state
import
org
apache
hadoop
hdfs
server
namenode
snapshot
snapshot
fs
image
format
import
org
apache
hadoop
hdfs
server
namenode
snapshot
snapshot
fs
image
format
reference
map
if
num
blocks
blk
read
fields
in
blocks
new
block
info
contiguous
under
construction
blk
block
replication
block
uc
state
under
construction
null
permission
status
perm
permission
status
read
in
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
fs
namesystem
java
import
org
apache
hadoop
hdfs
server
blockmanagement
block
collection
import
org
apache
hadoop
hdfs
server
blockmanagement
block
id
manager
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
blockmanagement
block
manager
import
org
apache
hadoop
hdfs
server
blockmanagement
datanode
descriptor
import
org
apache
hadoop
hdfs
server
blockmanagement
datanode
manager
throw
new
already
being
created
exception
message
case
under
construction
case
under
recovery
final
block
info
contiguous
under
construction
uc
block
info
contiguous
under
construction
last
block
block
recovery
block
uc
get
truncate
block
boolean
truncate
recovery
recovery
block
null
override
public
boolean
is
in
snapshot
block
info
contiguous
under
construction
block
uc
assert
has
read
lock
final
block
collection
bc
block
uc
get
block
collection
if
bc
null
bc
instanceof
node
file
wait
for
loading
fs
image
write
lock
boolean
copy
truncate
false
block
info
contiguous
under
construction
truncated
block
null
try
check
operation
operation
category
write
return
truncated
block
block
info
contiguous
under
construction
file
get
last
block
long
recovery
id
truncated
block
get
block
recovery
id
copy
truncate
truncated
block
get
block
id
stored
block
get
block
id
assert
has
write
lock
final
node
file
pending
file
check
uc
block
old
block
client
name
final
block
info
contiguous
under
construction
blockinfo
block
info
contiguous
under
construction
pending
file
get
last
block
if
new
block
get
generation
stamp
blockinfo
get
generation
stamp
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
file
under
construction
feature
java
import
org
apache
hadoop
classification
interface
audience
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
namenode
node
blocks
map
update
info
block
info
last
block
get
last
block
assert
last
block
null
the
last
block
for
path
get
full
path
name
is
null
when
updating
its
length
assert
last
block
instanceof
block
info
contiguous
under
construction
the
last
block
for
path
get
full
path
name
is
not
block
info
under
construction
when
updating
its
length
last
block
set
num
bytes
last
block
length
final
blocks
map
update
info
collected
blocks
final
block
info
blocks
get
blocks
if
blocks
null
blocks
length
blocks
blocks
length
instanceof
block
info
contiguous
under
construction
block
info
contiguous
under
construction
last
uc
block
info
contiguous
under
construction
blocks
blocks
length
if
last
uc
get
num
bytes
collected
blocks
add
delete
block
last
uc
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
node
file
java
import
org
apache
hadoop
hdfs
protocol
quota
exceeded
exception
import
org
apache
hadoop
hdfs
server
blockmanagement
block
collection
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
blockmanagement
block
storage
policy
suite
import
org
apache
hadoop
hdfs
server
blockmanagement
datanode
storage
info
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
block
uc
state
override
public
block
info
contiguous
under
construction
set
last
block
block
info
last
block
datanode
storage
info
locations
throws
io
exception
preconditions
check
state
is
under
construction
if
num
blocks
throw
new
io
exception
failed
to
set
last
block
file
is
empty
block
info
contiguous
under
construction
uc
block
last
block
convert
to
block
under
construction
block
uc
state
under
construction
locations
set
block
num
blocks
uc
block
block
info
contiguous
under
construction
remove
last
block
block
oldblock
preconditions
check
state
is
under
construction
file
is
no
longer
under
construction
if
blocks
null
blocks
length
return
null
block
info
contiguous
under
construction
uc
block
info
contiguous
under
construction
blocks
size
block
info
newlist
new
block
info
size
system
arraycopy
blocks
newlist
size
final
int
last
blocks
length
long
size
blocks
last
get
num
bytes
if
blocks
last
instanceof
block
info
contiguous
under
construction
if
includes
last
uc
block
size
else
if
use
preferred
block
sizelast
uc
block
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
namesystem
java
import
org
apache
hadoop
classification
interface
audience
import
org
apache
hadoop
hdfs
protocol
block
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
namenode
name
node
operation
category
import
org
apache
hadoop
hdfs
util
rw
lock
import
org
apache
hadoop
ipc
standby
exception
void
check
operation
operation
category
read
throws
standby
exception
boolean
is
in
snapshot
block
info
contiguous
under
construction
block
uc
cache
manager
get
cache
manager
no
newline
at
end
of
file
hadoop
hdfs
project
hadoop
hdfs
src
main
java
org
apache
hadoop
hdfs
server
namenode
snapshot
file
diff
list
java
import
org
apache
hadoop
hdfs
protocol
block
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
import
org
apache
hadoop
hdfs
server
namenode
node
import
org
apache
hadoop
hdfs
server
namenode
node
blocks
map
update
info
block
dont
remove
block
null
if
last
block
null
last
block
get
block
uc
state
equals
hdfs
server
constants
block
uc
state
under
recovery
dont
remove
block
block
info
contiguous
under
construction
last
block
get
truncate
block
hadoop
hdfs
project
hadoop
hdfs
src
test
java
org
apache
hadoop
hdfs
dfs
test
util
java
import
org
apache
hadoop
hdfs
security
token
block
block
token
identifier
import
org
apache
hadoop
hdfs
security
token
block
exported
block
keys
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
blockmanagement
block
manager
import
org
apache
hadoop
hdfs
server
blockmanagement
block
manager
test
util
import
org
apache
hadoop
hdfs
server
blockmanagement
datanode
descriptor
block
info
stored
block
bm
get
stored
block
blk
get
local
block
assert
true
block
blk
should
be
under
construction
got
stored
block
stored
block
instanceof
block
info
contiguous
under
construction
block
info
contiguous
under
construction
uc
block
block
info
contiguous
under
construction
stored
block
final
datanode
storage
info
storages
uc
block
get
expected
storage
locations
hadoop
hdfs
project
hadoop
hdfs
src
test
java
org
apache
hadoop
hdfs
server
blockmanagement
test
block
info
under
construction
java
import
org
apache
hadoop
hdfs
protocol
block
import
org
apache
hadoop
hdfs
server
common
generation
stamp
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
block
uc
state
import
org
apache
hadoop
util
time
import
org
junit
test
datanode
descriptor
dd
get
datanode
descriptor
dd
is
alive
dd
is
alive
dd
is
alive
true
block
info
contiguous
under
construction
block
info
new
block
info
contiguous
under
construction
new
block
generation
stamp
last
reserved
stamp
short
block
uc
state
under
construction
dfs
test
util
reset
last
updates
with
offset
dd
dfs
test
util
reset
last
updates
with
offset
dd
block
info
initialize
block
recovery
block
info
contiguous
under
construction
block
info
recovery
dd
get
lease
recovery
command
assert
equals
block
info
recovery
block
info
hadoop
hdfs
project
hadoop
hdfs
src
test
java
org
apache
hadoop
hdfs
server
blockmanagement
test
block
manager
java
assert
true
bm
get
stored
block
new
block
received
block
id
find
storage
info
ds
assert
true
block
info
contiguous
under
construction
bm
get
stored
block
new
block
receiving
block
id
get
num
expected
locations
assert
true
bm
get
stored
block
new
block
receiving
received
block
id
find
storage
info
ds
private
block
info
add
uc
block
to
bm
long
blk
id
block
block
new
block
blk
id
block
info
contiguous
under
construction
block
info
new
block
info
contiguous
under
construction
block
short
block
collection
bc
mockito
mock
block
collection
class
mockito
do
return
short
when
bc
get
preferred
block
replication
bm
blocks
map
add
block
collection
block
info
bc
hadoop
hdfs
project
hadoop
hdfs
src
test
java
org
apache
hadoop
hdfs
server
blockmanagement
test
heartbeat
handling
java
import
org
apache
hadoop
hdfs
server
protocol
datanode
protocol
import
org
apache
hadoop
hdfs
server
protocol
datanode
registration
import
org
apache
hadoop
hdfs
server
protocol
datanode
storage
import
org
apache
hadoop
util
time
import
org
junit
test
dd
get
storage
infos
dd
get
storage
infos
dd
get
storage
infos
block
info
contiguous
under
construction
block
info
new
block
info
contiguous
under
construction
new
block
generation
stamp
last
reserved
stamp
short
block
uc
state
under
recovery
storages
dd
add
block
to
be
recovered
block
info
dfs
test
util
reset
last
updates
with
offset
dd
dfs
test
util
reset
last
updates
with
offset
dd
block
info
new
block
info
contiguous
under
construction
new
block
generation
stamp
last
reserved
stamp
short
block
uc
state
under
recovery
storages
dd
add
block
to
be
recovered
block
info
dfs
test
util
reset
last
updates
with
offset
dd
dfs
test
util
reset
last
updates
with
offset
dd
block
info
new
block
info
contiguous
under
construction
new
block
generation
stamp
last
reserved
stamp
short
block
uc
state
under
recovery
storages
dd
add
block
to
be
recovered
block
info
hadoop
hdfs
project
hadoop
hdfs
src
test
java
org
apache
hadoop
hdfs
server
blockmanagement
test
replication
policy
java
block
info
contiguous
under
construction
info
new
block
info
contiguous
under
construction
block
short
block
collection
bc
mock
block
collection
class
when
bc
get
preferred
block
replication
then
return
short
bm
add
block
collection
info
bc
datanode
storage
info
storage
ary
new
datanode
storage
info
data
nodes
new
datanode
storage
final
block
info
contiguous
under
construction
uc
block
info
convert
to
block
under
construction
block
uc
state
under
construction
storage
ary
datanode
storage
info
storage
mock
datanode
storage
info
class
hadoop
hdfs
project
hadoop
hdfs
src
test
java
org
apache
hadoop
hdfs
server
namenode
test
block
under
construction
java
import
org
apache
hadoop
hdfs
protocol
located
block
import
org
apache
hadoop
hdfs
protocol
located
blocks
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
block
uc
state
import
org
apache
hadoop
hdfs
server
protocol
namenode
protocols
import
org
junit
after
class
final
list
located
block
blocks
lb
get
located
blocks
assert
equals
blocks
size
final
block
blocks
get
blocks
size
get
block
get
local
block
assert
true
instanceof
block
info
contiguous
under
construction
if
num
blocks
hadoop
hdfs
project
hadoop
hdfs
src
test
java
org
apache
hadoop
hdfs
server
namenode
test
commit
block
synchronization
java
import
org
apache
hadoop
hdfs
protocol
extended
block
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
blockmanagement
datanode
storage
info
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
import
org
junit
test
namesystem
dir
get
node
map
put
file
fs
namesystem
namesystem
spy
spy
namesystem
block
info
contiguous
under
construction
block
info
new
block
info
contiguous
under
construction
block
short
hdfs
server
constants
block
uc
state
under
construction
targets
block
info
set
block
collection
file
block
info
set
generation
stamp
gen
stamp
block
info
initialize
block
recovery
gen
stamp
hadoop
hdfs
project
hadoop
hdfs
src
test
java
org
apache
hadoop
hdfs
server
namenode
test
file
truncate
java
import
org
apache
hadoop
hdfs
protocol
hdfs
constants
safe
mode
action
import
org
apache
hadoop
hdfs
protocol
located
block
import
org
apache
hadoop
hdfs
protocol
located
blocks
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
import
org
apache
hadoop
hdfs
server
common
hdfs
server
constants
startup
option
import
org
apache
hadoop
security
user
group
information
is
fsn
get
block
id
manager
get
generation
stamp
assert
that
file
get
last
block
get
block
uc
state
is
hdfs
server
constants
block
uc
state
under
recovery
long
block
recovery
id
block
info
contiguous
under
construction
file
get
last
block
get
block
recovery
id
assert
that
block
recovery
id
is
initial
gen
stamp
fsn
get
edit
log
log
truncate
is
fsn
get
block
id
manager
get
generation
stamp
assert
that
file
get
last
block
get
block
uc
state
is
hdfs
server
constants
block
uc
state
under
recovery
long
block
recovery
id
block
info
contiguous
under
construction
file
get
last
block
get
block
recovery
id
assert
that
block
recovery
id
is
initial
gen
stamp
fsn
get
edit
log
log
truncate
hadoop
hdfs
project
hadoop
hdfs
src
test
java
org
apache
hadoop
hdfs
server
namenode
ha
test
retry
cache
with
ha
java
import
org
apache
hadoop
hdfs
protocol
last
block
with
status
import
org
apache
hadoop
hdfs
protocol
located
block
import
org
apache
hadoop
hdfs
protocol
located
blocks
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
namenode
fs
namesystem
import
org
apache
hadoop
hdfs
server
namenode
node
file
import
org
apache
hadoop
hdfs
server
namenode
snapshot
snapshot
test
helper
boolean
check
namenode
before
return
throws
exception
node
file
file
node
cluster
get
namesystem
get
fs
directory
get
nodewrite
file
as
file
block
info
contiguous
under
construction
blk
uc
block
info
contiguous
under
construction
file
node
get
blocks
int
datanode
num
blk
uc
get
expected
storage
locations
length
for
int
checktimes
datanode
num
thread
sleep
hadoop
hdfs
project
hadoop
hdfs
src
test
java
org
apache
hadoop
hdfs
server
namenode
snapshot
snapshot
test
helper
java
import
org
apache
hadoop
hdfs
mini
dfs
cluster
import
org
apache
hadoop
hdfs
protocol
hdfs
constants
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
import
org
apache
hadoop
hdfs
server
blockmanagement
block
info
contiguous
under
construction
import
org
apache
hadoop
hdfs
server
blockmanagement
block
manager
import
org
apache
hadoop
hdfs
server
datanode
block
pool
slice
storage
import
org
apache
hadoop
hdfs
server
datanode
block
scanner
